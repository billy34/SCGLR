<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function that fits and selects the number of component by cross-validation. — scglrCrossVal • SCGLR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Function that fits and selects the number of component by cross-validation. — scglrCrossVal" />
<meta property="og:description" content="Function that fits and selects the number of component by cross-validation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCGLR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SCGLR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mixedSCGLR.html">Mixed SCGLR example</a>
    </li>
    <li>
      <a href="../articles/parallelization.html">How to use parallelization</a>
    </li>
    <li>
      <a href="../articles/progression.html">How display progression</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SCnext/SCGLR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function that fits and selects the number of component by cross-validation.</h1>
    <small class="dont-index">Source: <a href='https://github.com/SCnext/SCGLR/blob/master/R/scglrCrossVal.r'><code>R/scglrCrossVal.r</code></a></small>
    <div class="hidden name"><code>scglrCrossVal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that fits and selects the number of component by cross-validation.</p>
    </div>

    <pre class="usage"><span class='fu'>scglrCrossVal</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>data</span>,
  <span class='va'>family</span>,
  K <span class='op'>=</span> <span class='fl'>1</span>,
  folds <span class='op'>=</span> <span class='fl'>10</span>,
  type <span class='op'>=</span> <span class='st'>"mspe"</span>,
  size <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  na.action <span class='op'>=</span> <span class='va'>na.omit</span>,
  crit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='fu'><a href='methodSR.html'>methodSR</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>nfolds</span>,
  <span class='va'>mc.cores</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class "Formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>the data frame to be modeled.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>a vector of character of length q specifying the distributions of the responses. Bernoulli, binomial, poisson and gaussian are allowed.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>number of components, default is one.</p></td>
    </tr>
    <tr>
      <th>folds</th>
      <td><p>number of folds, default is 10.
Although folds can be as large as the sample size (leave-one-out CV),
it is not recommended for large datasets.
folds can also be provided as a vector (same length as data) of fold identifiers.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>loss function to use for cross-validation.
Currently six options are available depending on whether the responses are of the same distribution family.
If the responses are all bernoulli distributed, then the prediction performance may be measured
through the area under the ROC curve: type = "auc"
In any other case one can choose among the following five options ("likelihood","aic","aicc","bic","mspe").</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>specifies the number of trials of the binomial variables included in the model.  A (n*qb) matrix is expected
for qb binomial variables.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>used for the poisson dependent variables.
A vector or a matrix of size: number of observations * number of Poisson dependent variables is expected.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function which indicates what should happen when the data contain NAs. The default is set to the <code>na.omit</code>.</p></td>
    </tr>
    <tr>
      <th>crit</th>
      <td><p>a list of two elements : maxit and tol, describing respectively the maximum number of iterations and
the tolerance convergence criterion for the Fisher scoring algorithm. Default is set to 50 and 10e-6 respectively.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Regularization criterion type. Object of class "method.SCGLR"
built by <code><a href='methodSR.html'>methodSR</a></code> for Structural Relevance.</p></td>
    </tr>
    <tr>
      <th>nfolds</th>
      <td><p>deprecated. Use <code>fold</code> parameter instead.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>deprecated</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a matrix containing the criterion values for each response (rows) and each number of components (columns).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bry X., Trottier C., Verron T. and Mortier F. (2013) Supervised Component Generalized Linear Regression using a PLS-extension of the Fisher scoring algorithm. <em>Journal of Multivariate Analysis</em>, 119, 47-60.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scnext.github.io/SCGLR'>SCGLR</a></span><span class='op'>)</span>

<span class='co'># load sample data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>genus</span><span class='op'>)</span>

<span class='co'># get variable names from dataset</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>genus</span><span class='op'>)</span>
<span class='va'>ny</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"^gen"</span>,<span class='va'>n</span><span class='op'>)</span><span class='op'>]</span>    <span class='co'># Y &lt;- names that begins with "gen"</span>
<span class='va'>nx</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"^gen"</span>,<span class='va'>n</span><span class='op'>)</span><span class='op'>]</span>   <span class='co'># X &lt;- remaining names</span>

<span class='co'># remove "geology" and "surface" from nx</span>
<span class='co'># as surface is offset and we want to use geology as additional covariate</span>
<span class='va'>nx</span> <span class='op'>&lt;-</span><span class='va'>nx</span><span class='op'>[</span><span class='op'>!</span><span class='va'>nx</span><span class='op'>%in%</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"geology"</span>,<span class='st'>"surface"</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># build multivariate formula</span>
<span class='co'># we also add "lat*lon" as computed covariate</span>
<span class='va'>form</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multivariateFormula.html'>multivariateFormula</a></span><span class='op'>(</span><span class='va'>ny</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>nx</span>,<span class='st'>"I(lat*lon)"</span><span class='op'>)</span>,A<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"geology"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># define family</span>
<span class='va'>fam</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"poisson"</span>,<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ny</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># cross validation</span>
<span class='va'>genus.cv</span> <span class='op'>&lt;-</span> <span class='fu'>scglrCrossVal</span><span class='op'>(</span>formula<span class='op'>=</span><span class='va'>form</span>, data<span class='op'>=</span><span class='va'>genus</span>, family<span class='op'>=</span><span class='va'>fam</span>, K<span class='op'>=</span><span class='fl'>12</span>,
 offset<span class='op'>=</span><span class='va'>genus</span><span class='op'>$</span><span class='va'>surface</span><span class='op'>)</span>

<span class='co'># find best K</span>
<span class='va'>mean.crit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>genus.cv</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#plot(mean.crit, type="l")</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Guillaume Cornu, Frederic Mortier, Catherine Trottier, Xavier Bry, Jocelyn Chauvet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


